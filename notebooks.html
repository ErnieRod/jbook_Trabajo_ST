
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Proyecto - Modelamiento de una serie de tiempo para predecir el consumo de transmisiones en camiones mineros &#8212; Tarea 1 - Proyecto</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to your Jupyter Book" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Tarea 1 - Proyecto - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Tarea 1 - Proyecto - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Proyecto - Modelamiento de una serie de tiempo para predecir el consumo de transmisiones en camiones mineros</a></li>










</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fnotebooks.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/notebooks.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Proyecto - Modelamiento de una serie de tiempo para predecir el consumo de transmisiones en camiones mineros</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Proyecto - Modelamiento de una serie de tiempo para predecir el consumo de transmisiones en camiones mineros</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#iniciamos-con-el-eda-de-la-serie-que-se-requiere-estudiar">Iniciamos con el EDA de la serie que se requiere estudiar</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#test-de-normalidad-de-los-datos">Test de Normalidad de los datos</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#validacion-de-datos-faltantes">Validacion de datos faltantes</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#generacion-de-la-serie-de-tiempo">Generacion de la serie de tiempo</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#se-determinara-a-que-modelo-se-ajustan-nuestros-datos">Se determinara a que modelo se ajustan nuestros datos:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#validacion-de-estacionalidad-de-la-serie">Validacion de estacionalidad de la serie</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#descomposicion-de-mi-serie">Descomposicion de mi serie</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#suavizacion-exponencial">Suavizacion exponencial</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-autorregresivo-integral-de-media-movil">MODELO AUTORREGRESIVO INTEGRAL DE MEDIA MOVIL</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-con-modelos-de-machine-learnig">Prueba con modelos de Machine Learnig</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="proyecto-modelamiento-de-una-serie-de-tiempo-para-predecir-el-consumo-de-transmisiones-en-camiones-mineros">
<h1>Proyecto - Modelamiento de una serie de tiempo para predecir el consumo de transmisiones en camiones mineros<a class="headerlink" href="#proyecto-modelamiento-de-una-serie-de-tiempo-para-predecir-el-consumo-de-transmisiones-en-camiones-mineros" title="Link to this heading">#</a></h1>
<p>Introduccion
El tren de potencia de un camion minero consta de varios componentes importantes que le permiten poder acarrear grandes cantidades de material esteril (tierra) o material mineral. Entre estos componentes se encuentra la servo transmision, la cual contiene un conjunto de embragues que asociados entre si dan lugar a las diferentes velocidades del equipo.
Este componente es un eslabon fragil del tren de potencia porque podria ser afectado por una mala operacion, por un deficiente mantenimiento o por una mala reconstruccion. Debido a esto es de gran analisis para el equipo de confiabilidad y de planeacion.
Con base en esta informacion se requiere poder pronosticar cuanto sera el consumo de este componente en los proximos meses.
La informacion historica con la que se cuenta es el consumo mensual desde el año 2010.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">openpyxl</span> <span class="o">--</span><span class="n">quiet</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Cargar el archivo Excel usando la ruta correcta</span>
<span class="n">ruta_archivo</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Users\erodr\Downloads\Series de tiempo.xlsx&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">ruta_archivo</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Export Worksheet&#39;</span><span class="p">)</span>

<span class="c1"># Convertir la columna &#39;FECHA&#39; a formato de fecha</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;FECHA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;FECHA&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Extraer año y mes de la columna &#39;FECHA&#39;</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;FECHA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;FECHA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>

<span class="c1"># Agrupar por Año y Mes para totalizar el consumo</span>
<span class="n">consumo_mensual</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Month&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Consumption&#39;</span><span class="p">)</span>

<span class="c1"># Mostrar los primeros resultados del nuevo DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="n">consumo_mensual</span><span class="p">)</span>

<span class="c1"># Guardar los resultados a un nuevo archivo Excel</span>
<span class="n">consumo_mensual</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;consumo_mensual.xlsx&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Year  Month  Consumption
0    2010      9           12
1    2010     10            4
2    2010     11            5
3    2010     12            2
4    2011      2            3
..    ...    ...          ...
157  2024      5            8
158  2024      6           11
159  2024      7            4
160  2024      8            9
161  2024      9            4

[162 rows x 3 columns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">statsmodels</span> <span class="o">--</span><span class="n">quiet</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">seaborn</span> <span class="o">--</span><span class="n">upgrade</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: seaborn in c:\users\erodr\miniconda3\envs\ml_venv\lib\site-packages (0.13.2)
Requirement already satisfied: numpy!=1.24.0,&gt;=1.20 in c:\users\erodr\miniconda3\envs\ml_venv\lib\site-packages (from seaborn) (1.25.2)
Requirement already satisfied: pandas&gt;=1.2 in c:\users\erodr\miniconda3\envs\ml_venv\lib\site-packages (from seaborn) (2.2.3)
Requirement already satisfied: matplotlib!=3.6.1,&gt;=3.4 in c:\users\erodr\miniconda3\envs\ml_venv\lib\site-packages (from seaborn) (3.7.2)
Requirement already satisfied: contourpy&gt;=1.0.1 in c:\users\erodr\miniconda3\envs\ml_venv\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (1.1.0)
Requirement already satisfied: cycler&gt;=0.10 in c:\users\erodr\miniconda3\envs\ml_venv\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (0.11.0)
Requirement already satisfied: fonttools&gt;=4.22.0 in c:\users\erodr\miniconda3\envs\ml_venv\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (4.42.1)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in c:\users\erodr\miniconda3\envs\ml_venv\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (1.4.5)
Requirement already satisfied: packaging&gt;=20.0 in c:\users\erodr\miniconda3\envs\ml_venv\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (23.1)
Requirement already satisfied: pillow&gt;=6.2.0 in c:\users\erodr\miniconda3\envs\ml_venv\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (10.0.0)
Requirement already satisfied: pyparsing&lt;3.1,&gt;=2.3.1 in c:\users\erodr\miniconda3\envs\ml_venv\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (3.0.9)
Requirement already satisfied: python-dateutil&gt;=2.7 in c:\users\erodr\miniconda3\envs\ml_venv\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (2.8.2)
Requirement already satisfied: importlib-resources&gt;=3.2.0 in c:\users\erodr\miniconda3\envs\ml_venv\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (6.0.1)
Requirement already satisfied: pytz&gt;=2020.1 in c:\users\erodr\miniconda3\envs\ml_venv\lib\site-packages (from pandas&gt;=1.2-&gt;seaborn) (2023.3)
Requirement already satisfied: tzdata&gt;=2022.7 in c:\users\erodr\miniconda3\envs\ml_venv\lib\site-packages (from pandas&gt;=1.2-&gt;seaborn) (2023.3)
Requirement already satisfied: zipp&gt;=3.1.0 in c:\users\erodr\miniconda3\envs\ml_venv\lib\site-packages (from importlib-resources&gt;=3.2.0-&gt;matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (3.16.2)
Requirement already satisfied: six&gt;=1.5 in c:\users\erodr\miniconda3\envs\ml_venv\lib\site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (1.16.0)
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="iniciamos-con-el-eda-de-la-serie-que-se-requiere-estudiar">
<h1>Iniciamos con el EDA de la serie que se requiere estudiar<a class="headerlink" href="#iniciamos-con-el-eda-de-la-serie-que-se-requiere-estudiar" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">consumo_mensual</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">consumo_mensual</span><span class="p">[[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Month&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">DAY</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># Gráfico de líneas para observar la tendencia</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Consumption&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">consumo_mensual</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Consumo Mensual a lo Largo del Tiempo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Consumo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b3977f6361ec988fe2a45f419bdb58a46fc4c1db7f14323bdc0f4f898a61971a.png" src="_images/b3977f6361ec988fe2a45f419bdb58a46fc4c1db7f14323bdc0f4f898a61971a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gráfico de barras agrupado por año y mes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Consumption&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">consumo_mensual</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Set1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Consumo Mensual Desglosado por Año&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Consumo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Año&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1a1d3da445f47de3f4a47c5ad19ba17547762e1ad49f1fe2f2c0dbb80bacddd5.png" src="_images/1a1d3da445f47de3f4a47c5ad19ba17547762e1ad49f1fe2f2c0dbb80bacddd5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gráfico de líneas por cada año</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">consumo_mensual</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">consumo_mensual</span><span class="p">[</span><span class="n">consumo_mensual</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">year</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Consumption&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Año </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Consumo Mensual por Año - Gráfico de Subserie Estacional&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Consumo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Año&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2671c62ec742ebec824653460b348dea9f450f8e9671c25af6dd8e0f66750e4b.png" src="_images/2671c62ec742ebec824653460b348dea9f450f8e9671c25af6dd8e0f66750e4b.png" />
</div>
</div>
<p>Este gráfico muestra cómo varía el consumo en cada mes para diferentes años, permitiéndote identificar patrones estacionales.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gráfico de caja para mostrar la distribución del consumo por mes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Consumption&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">consumo_mensual</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribución del Consumo por Mes - Gráfico de Cajas Múltiples por Mes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Consumo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dd56917fe2a0eece1358a037040df9795ed463a0d8ee1fa713803023248aa21b.png" src="_images/dd56917fe2a0eece1358a037040df9795ed463a0d8ee1fa713803023248aa21b.png" />
</div>
</div>
<p>Este grafico permite visualizar la variabilidad y distribución del consumo para cada mes. Si los gráficos de cajas muestran variaciones significativas entre los meses, esto indica un componente estacional.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calcular el consumo promedio por mes</span>
<span class="n">consumo_promedio_mensual</span> <span class="o">=</span> <span class="n">consumo_mensual</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">)[</span><span class="s1">&#39;Consumption&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># Gráfico de barras del consumo promedio por mes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Consumption&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">consumo_promedio_mensual</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Consumo Promedio por Mes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Consumo Promedio&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Ene&#39;</span><span class="p">,</span> <span class="s1">&#39;Feb&#39;</span><span class="p">,</span> <span class="s1">&#39;Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;Abr&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;Jun&#39;</span><span class="p">,</span> <span class="s1">&#39;Jul&#39;</span><span class="p">,</span> <span class="s1">&#39;Ago&#39;</span><span class="p">,</span> <span class="s1">&#39;Sep&#39;</span><span class="p">,</span> <span class="s1">&#39;Oct&#39;</span><span class="p">,</span> <span class="s1">&#39;Nov&#39;</span><span class="p">,</span> <span class="s1">&#39;Dic&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/91cb5827c7712eabebb5973ae60f9e60783d247b4668c808d18cc284687fd815.png" src="_images/91cb5827c7712eabebb5973ae60f9e60783d247b4668c808d18cc284687fd815.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.holtwinters</span> <span class="kn">import</span> <span class="n">SimpleExpSmoothing</span>  

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;darkgrid&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="test-de-normalidad-de-los-datos">
<h1>Test de Normalidad de los datos<a class="headerlink" href="#test-de-normalidad-de-los-datos" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">shapiro</span><span class="p">,</span> <span class="n">kstest</span>

<span class="c1"># Shapiro-Wilk Test</span>
<span class="n">stat_shapiro</span><span class="p">,</span> <span class="n">p_shapiro</span> <span class="o">=</span> <span class="n">shapiro</span><span class="p">(</span><span class="n">consumo_mensual</span><span class="p">[</span><span class="s1">&#39;Consumption&#39;</span><span class="p">])</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Shapiro-Wilk Test:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Statistics=</span><span class="si">{</span><span class="n">stat_shapiro</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1">, p-value=</span><span class="si">{</span><span class="n">p_shapiro</span><span class="si">:</span><span class="s1">.6e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">p_shapiro</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sample looks Normal (fail to reject H0)&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sample does not look Normal (reject H0)&#39;</span><span class="p">)</span>

<span class="c1"># Kolmogorov-Smirnov Test</span>
<span class="n">stat_kstest</span><span class="p">,</span> <span class="n">p_kstest</span> <span class="o">=</span> <span class="n">kstest</span><span class="p">(</span><span class="n">consumo_mensual</span><span class="p">[</span><span class="s1">&#39;Consumption&#39;</span><span class="p">],</span> <span class="s1">&#39;norm&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Kolmogorov-Smirnov Test:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Statistics=</span><span class="si">{</span><span class="n">stat_kstest</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1">, p-value=</span><span class="si">{</span><span class="n">p_kstest</span><span class="si">:</span><span class="s1">.6e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">p_kstest</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sample looks Normal (fail to reject H0)&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sample does not look Normal (reject H0)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shapiro-Wilk Test:
Statistics=0.967419, p-value=7.269453e-04
Sample does not look Normal (reject H0)

Kolmogorov-Smirnov Test:
Statistics=0.878484, p-value=1.325264e-148
Sample does not look Normal (reject H0)
</pre></div>
</div>
</div>
</div>
<p>Con los valores obtenidos en la pruebas anteriores podemos decir que la hipotesis nula se rechaza al tener valores de p-value por debajo de 0.05 y por ende no cumplen con el supuesto de normalidad.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">normaltest</span><span class="p">,</span> <span class="n">laplace</span><span class="p">,</span> <span class="n">hypsecant</span><span class="p">,</span> <span class="n">logistic</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">cosine</span><span class="p">,</span> <span class="n">semicircular</span><span class="p">,</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">kurtosis</span>



<span class="n">data</span> <span class="o">=</span> <span class="n">consumo_mensual</span><span class="p">[</span><span class="s1">&#39;Consumption&#39;</span><span class="p">]</span>

<span class="c1"># Prueba de D&#39;Agostino K2</span>
<span class="n">stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">normaltest</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;D</span><span class="se">\&#39;</span><span class="s1">Agostino K-squared Test:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Statistics=</span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1">, p-value=</span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s1">.6e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">p_value</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sample looks Normal (fail to reject H0)&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sample does not look Normal (reject H0)&#39;</span><span class="p">)</span>

<span class="c1"># Calcular la curtosis de los datos originales</span>
<span class="n">data_kurtosis</span> <span class="o">=</span> <span class="n">kurtosis</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Kurtosis of the original data: </span><span class="si">{</span><span class="n">data_kurtosis</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Generar gráficos para comparar con diferentes distribuciones</span>
<span class="n">distributions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Laplace&#39;</span><span class="p">:</span> <span class="n">laplace</span><span class="p">,</span>
    <span class="s1">&#39;Hyperbolic Secant&#39;</span><span class="p">:</span> <span class="n">hypsecant</span><span class="p">,</span>
    <span class="s1">&#39;Logistic&#39;</span><span class="p">:</span> <span class="n">logistic</span><span class="p">,</span>
    <span class="s1">&#39;Normal&#39;</span><span class="p">:</span> <span class="n">norm</span><span class="p">,</span>
    <span class="s1">&#39;Cosine&#39;</span><span class="p">:</span> <span class="n">cosine</span><span class="p">,</span>
    <span class="s1">&#39;Semicircular&#39;</span><span class="p">:</span> <span class="n">semicircular</span><span class="p">,</span>
    <span class="s1">&#39;Uniform&#39;</span><span class="p">:</span> <span class="n">uniform</span>
<span class="p">}</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Histograma de los datos</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data Histogram&#39;</span><span class="p">)</span>

<span class="c1"># Calcular y mostrar la curtosis para cada distribución</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Kurtosis for each distribution:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">dist_name</span><span class="p">,</span> <span class="n">dist</span> <span class="ow">in</span> <span class="n">distributions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="c1"># Ajustar la distribución a los datos</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="c1"># Calcular la curtosis teórica</span>
    <span class="n">dist_kurtosis</span> <span class="o">=</span> <span class="n">dist</span><span class="p">(</span><span class="o">*</span><span class="n">params</span><span class="p">)</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="n">moments</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dist_name</span><span class="si">}</span><span class="s1"> Distribution: Kurtosis = </span><span class="si">{</span><span class="n">dist_kurtosis</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="c1"># Graficar la distribución</span>
    <span class="n">pdf</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dist_name</span><span class="si">}</span><span class="s1"> Distribution&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparison of Data with Various Distributions&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Consumption&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>D&#39;Agostino K-squared Test:
Statistics=4.291423, p-value=1.169847e-01
Sample looks Normal (fail to reject H0)

Kurtosis of the original data: -0.471409

Kurtosis for each distribution:
Laplace Distribution: Kurtosis = 3.000000
Hyperbolic Secant Distribution: Kurtosis = 2.000000
Logistic Distribution: Kurtosis = 1.200000
Normal Distribution: Kurtosis = 0.000000
Cosine Distribution: Kurtosis = -0.593763
Semicircular Distribution: Kurtosis = -1.000000
Uniform Distribution: Kurtosis = -1.200000
</pre></div>
</div>
<img alt="_images/c4aaa31edeaa12fa418034df1db141a4f4025eef84b89cc0705a1e26cb06480b.png" src="_images/c4aaa31edeaa12fa418034df1db141a4f4025eef84b89cc0705a1e26cb06480b.png" />
</div>
</div>
<p>Dado que la prueba de D’Agostino K-squared no rechaza la hipótesis nula de normalidad y que la curtosis de los datos originales está cercana a 0 (la curtosis de la distribución normal), se podria concluir erroneamente que los datos podrían ser modelados adecuadamente con una distribución normal, sin embargo al comparar con las pruebas de supuesto de Shapiro-Wilk y Kolmogorov-Smirnov las cuales sugieren que los datos no siguen una distribución normal, se podria concluir lo siguiente:
La prueba de D’Agostino K-squared se basa en la asimetría y la curtosis para evaluar la normalidad. Los datos pueden tener una forma general que se asemeja a una distribución normal en términos de sesgo y curtosis, lo que podría conducir a un resultado que “parezca” normal.
Las pruebas de Shapiro-Wilk y Kolmogorov-Smirnov son más sensibles a pequeñas desviaciones de la normalidad en la forma de los datos y pueden detectar irregularidades que el test de D’Agostino podría pasar por alto.
La curtosis negativa sugiere una distribución más plana con colas más delgadas que la normal. Aunque esto no implica necesariamente que los datos no sean normales, puede indicar que hay una ligera desviación que las pruebas de Shapiro-Wilk y Kolmogorov-Smirnov detectaron, mientras que el test de D’Agostino no lo hizo.
El tamaño de la muestra puede afectar la sensibilidad de las pruebas de normalidad. En muestras pequeñas, algunas pruebas pueden tener dificultades para detectar la verdadera naturaleza de la distribución. Las discrepancias entre las pruebas podrían deberse a cómo manejan la variabilidad en muestras más pequeñas. Shapiro-Wilk y Kolmogorov-Smirnov son generalmente más confiables para detectar la normalidad, especialmente en muestras más pequeñas, por lo tanto, es más prudente considerar que los datos no siguen una distribución normal.</p>
</section>
<section id="validacion-de-datos-faltantes">
<h1>Validacion de datos faltantes<a class="headerlink" href="#validacion-de-datos-faltantes" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Verificar si hay datos faltantes en el DataFrame `consumo_mensual`</span>
<span class="n">missing_values_count</span> <span class="o">=</span> <span class="n">consumo_mensual</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">missing_values_mean</span> <span class="o">=</span> <span class="n">consumo_mensual</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Mostrar los resultados</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Número de valores faltantes por columna:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">missing_values_count</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Proporción de valores faltantes por columna:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">missing_values_mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Número de valores faltantes por columna:
Year           0
Month          0
Consumption    0
Date           0
dtype: int64

Proporción de valores faltantes por columna:
Year           0.0
Month          0.0
Consumption    0.0
Date           0.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>No se tienen datos faltantes, por lo tanto continuamos con nuestro estudio.</p>
</section>
<section id="generacion-de-la-serie-de-tiempo">
<h1>Generacion de la serie de tiempo<a class="headerlink" href="#generacion-de-la-serie-de-tiempo" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convertir la serie de consumo mensual a una serie de tiempo</span>
<span class="n">consumo_ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">consumo_mensual</span><span class="p">[</span><span class="s1">&#39;Consumption&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">consumo_mensual</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>


<span class="c1"># Graficar la serie original </span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Consumo Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Consumo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/edaffe931730913f0157283bfe35e795e3046b60ab71e84562a06c00317502f4.png" src="_images/edaffe931730913f0157283bfe35e795e3046b60ab71e84562a06c00317502f4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Generar la serie de tiempo tomando el consumo mensual de componentes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>


<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Consumo Mensual de Componentes - Serie de Tiempo&#39;</span><span class="p">)</span>
<span class="n">consumo_mensual</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Consumption&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Consumo acumulado</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Consumo Acumulado de Componentes - Serie de Tiempo&#39;</span><span class="p">)</span>
<span class="n">consumo_mensual</span><span class="p">[</span><span class="s1">&#39;Cumulative Consumption&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">consumo_mensual</span><span class="p">[</span><span class="s1">&#39;Consumption&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">consumo_mensual</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Cumulative Consumption&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tiempo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/981b4fb03e80fec0267938882dce286cd67c66db3454cb7966febd6c95e648fa.png" src="_images/981b4fb03e80fec0267938882dce286cd67c66db3454cb7966febd6c95e648fa.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Convertir la columna &#39;Year&#39; y &#39;Month&#39; a una columna de fecha y configurar como índice</span>
<span class="n">consumo_mensual</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">consumo_mensual</span><span class="p">[[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Month&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">Day</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">consumo_ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">consumo_mensual</span><span class="p">[</span><span class="s1">&#39;Consumption&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">consumo_mensual</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>

<span class="c1"># Calcular la media móvil para mostrar la tendencia (por ejemplo, media móvil de 12 meses)</span>
<span class="n">consumo_ts_trend</span> <span class="o">=</span> <span class="n">consumo_ts</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Graficar los datos originales y la tendencia</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Consumo Original&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">consumo_ts_trend</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Tendencia (Media Móvil 12 meses)&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Consumo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Consumo Mensual de Componentes y Tendencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6d3443037fbd480960caee4f71c5b6fc86bbc2a7e349b9e26eead6fea9b874cb.png" src="_images/6d3443037fbd480960caee4f71c5b6fc86bbc2a7e349b9e26eead6fea9b874cb.png" />
</div>
</div>
</section>
<section id="se-determinara-a-que-modelo-se-ajustan-nuestros-datos">
<h1>Se determinara a que modelo se ajustan nuestros datos:<a class="headerlink" href="#se-determinara-a-que-modelo-se-ajustan-nuestros-datos" title="Link to this heading">#</a></h1>
<p>Modelos de Media Cero
Recorrido aleatorio
Modelos de tendencia
Modelos de estacionalidad</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calcular la media de la serie</span>
<span class="n">mean_consumption</span> <span class="o">=</span> <span class="n">consumo_ts</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Restar la media a la serie y graficar</span>
<span class="n">zero_mean_series</span> <span class="o">=</span> <span class="n">consumo_ts</span> <span class="o">-</span> <span class="n">mean_consumption</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">zero_mean_series</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Modelo de Media Cero&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Consumo Ajustado&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4e96fe0e4f26185d93800af774904b9d1ff47fcc7b5de709ffb2bc966d51cf32.png" src="_images/4e96fe0e4f26185d93800af774904b9d1ff47fcc7b5de709ffb2bc966d51cf32.png" />
</div>
</div>
<p>Se concluye con este grafico que nuestros datos no se ajustan a un modelo de media cero, ya que los datos no fluctúan alrededor de la línea roja en la gráfica</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Convertir el índice de fecha a números (ejemplo: días desde la primera fecha)</span>
<span class="n">consumo_ts_numeric_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">consumo_ts</span><span class="o">.</span><span class="n">index</span> <span class="o">-</span> <span class="n">consumo_ts</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">days</span>

<span class="c1"># Ajustar una línea de tendencia lineal</span>
<span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">consumo_ts_numeric_index</span><span class="p">,</span> <span class="n">consumo_ts</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="c1"># Crear la línea de tendencia</span>
<span class="n">trend_line</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">consumo_ts_numeric_index</span>

<span class="c1"># Graficar la serie original y la línea de tendencia</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Serie Original&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">consumo_ts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">trend_line</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Tendencia Lineal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Modelo de Tendencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Consumo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1064ee5343d80d24770db044abfe45302c3c507639a8a4cc6b550266758fb9d1.png" src="_images/1064ee5343d80d24770db044abfe45302c3c507639a8a4cc6b550266758fb9d1.png" />
</div>
</div>
<p>Se finaliza el EDA y se procede con el paso 2 definido en el analisis de datos de series temporales</p>
<p><img alt="image.png" src="attachment:image.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Calcular la media móvil mensual (ventana de 30 días)</span>
<span class="n">consumo_ts_moving_avg_monthly</span> <span class="o">=</span> <span class="n">consumo_ts</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Graficar solo la media móvil mensual</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">consumo_ts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">consumo_ts_moving_avg_monthly</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Media Móvil Mensual (30 días)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Medias Móviles Mensuales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Consumo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d6d351624970df301dbe17c36406ec811f33a7564693ada54f4d8c68abb50b08.png" src="_images/d6d351624970df301dbe17c36406ec811f33a7564693ada54f4d8c68abb50b08.png" />
</div>
</div>
<p>Este medida permite identificar tendencias, cambios significativos y estacionalidad.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Calcular la media móvil anual (ventana de 365 días)</span>
<span class="n">consumo_ts_moving_avg_annual</span> <span class="o">=</span> <span class="n">consumo_ts</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">365</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Graficar solo la media móvil anual</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">consumo_ts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">consumo_ts_moving_avg_annual</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Media Móvil Anual (365 días)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Medias Móviles Anuales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Consumo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9388c227f27100d9d52c328656a71f4b6799a9c1c9bbf13d444c232e062c488f.png" src="_images/9388c227f27100d9d52c328656a71f4b6799a9c1c9bbf13d444c232e062c488f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Diferenciación de primer orden (para eliminar tendencia)</span>
<span class="n">consumo_diff_1</span> <span class="o">=</span> <span class="n">consumo_ts</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Diferenciación estacional (por ejemplo, anual: 12 meses)</span>
<span class="n">consumo_diff_seasonal</span> <span class="o">=</span> <span class="n">consumo_ts</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Graficar las series diferenciadas</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Gráfico de la diferenciación de primer orden</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">consumo_diff_1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Diferenciación de Primer Orden&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Diferenciación de Tendencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Consumo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>

<span class="c1"># Gráfico de la diferenciación estacional</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">consumo_diff_seasonal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Diferenciación Estacional (12 meses)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Diferenciación Estacional&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Consumo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a5b1b230f12d6c2884893cd96835b55a65c14ae17381ce9f030a84c4579173c8.png" src="_images/a5b1b230f12d6c2884893cd96835b55a65c14ae17381ce9f030a84c4579173c8.png" />
</div>
</div>
</section>
<section id="validacion-de-estacionalidad-de-la-serie">
<h1>Validacion de estacionalidad de la serie<a class="headerlink" href="#validacion-de-estacionalidad-de-la-serie" title="Link to this heading">#</a></h1>
<p>A traves de la prueba ADF se valida esatacionalidad</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">adfuller</span>

<span class="c1"># Aplicar la Prueba de Dickey-Fuller Aumentada</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">)</span>

<span class="c1"># Extraer e imprimir los resultados</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Resultados de la Prueba de Dickey-Fuller Aumentada:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Estadístico ADF: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Valor p: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Número de retardos utilizados: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Número de observaciones: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Valores críticos:&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;   </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Interpretar el resultado</span>
<span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">La serie es estacionaria (rechazamos la hipótesis nula).&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">La serie no es estacionaria (no se puede rechazar la hipótesis nula).&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados de la Prueba de Dickey-Fuller Aumentada:
Estadístico ADF: -5.6646
Valor p: 0.0000
Número de retardos utilizados: 1
Número de observaciones: 160
Valores críticos:
   1%: -3.4719
   5%: -2.8798
   10%: -2.5765

La serie es estacionaria (rechazamos la hipótesis nula).
</pre></div>
</div>
</div>
</div>
</section>
<section id="descomposicion-de-mi-serie">
<h1>Descomposicion de mi serie<a class="headerlink" href="#descomposicion-de-mi-serie" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.seasonal</span> <span class="kn">import</span> <span class="n">seasonal_decompose</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Descomponer la serie de tiempo (suponiendo frecuencia mensual)</span>
<span class="n">decomposition</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Extraer los componentes</span>
<span class="n">trend</span> <span class="o">=</span> <span class="n">decomposition</span><span class="o">.</span><span class="n">trend</span>
<span class="n">seasonal</span> <span class="o">=</span> <span class="n">decomposition</span><span class="o">.</span><span class="n">seasonal</span>
<span class="n">residual</span> <span class="o">=</span> <span class="n">decomposition</span><span class="o">.</span><span class="n">resid</span>

<span class="c1"># Graficar los componentes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Serie original</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Serie Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Descomposición de la Serie Temporal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>

<span class="c1"># Tendencia</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trend</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Tendencia&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>

<span class="c1"># Estacionalidad</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">seasonal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Estacionalidad&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>

<span class="c1"># Residuo</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">residual</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Residuo&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4159a3476ac919cacf236b1e786560376246b4551954087e6cfedcc05151730f.png" src="_images/4159a3476ac919cacf236b1e786560376246b4551954087e6cfedcc05151730f.png" />
</div>
</div>
<p>La descomposición es crucial para entender las características internas de la serie de tiempo. Al separar la tendencia, la estacionalidad y el residuo, se facilita la construcción de modelos predictivos, como modelos ARIMA o SARIMA.
También es útil para evaluar la estacionalidad de forma más clara, ya que muestra los patrones repetitivos en un gráfico separado.</p>
<p>Interpretación
Serie Original: Muestra los datos brutos tal como se registraron.</p>
<p>Tendencia: Visualiza el movimiento a largo plazo en los datos, lo que permite observar si hay una subida, bajada o cambios en la dirección general.</p>
<p>Estacionalidad: Muestra los patrones repetitivos que ocurren en intervalos regulares. Esto te ayuda a identificar ciclos que ocurren cada año, mes, semana, etc.</p>
<p>Residuo: Lo que queda después de eliminar la tendencia y la estacionalidad. Si los residuos parecen ruido blanco (fluctúan alrededor de cero sin patrón), el modelo de descomposición es apropiado.</p>
</section>
<section id="suavizacion-exponencial">
<h1>Suavizacion exponencial<a class="headerlink" href="#suavizacion-exponencial" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Función de suavización exponencial de primer orden</span>
<span class="k">def</span> <span class="nf">firstsmooth</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">ytilde</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ytilde</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lambda_</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">lambda_</span><span class="p">)</span> <span class="o">*</span> <span class="n">start</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
        <span class="n">ytilde</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lambda_</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">lambda_</span><span class="p">)</span> <span class="o">*</span> <span class="n">ytilde</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">ytilde</span>

<span class="c1"># Parámetro de suavización (lambda), valor entre 0 y 1</span>
<span class="n">lambda_</span> <span class="o">=</span> <span class="mf">0.3</span>

<span class="c1"># Aplicar la suavización exponencial de primer orden a la serie de tiempo</span>
<span class="n">smoothed_series</span> <span class="o">=</span> <span class="n">firstsmooth</span><span class="p">(</span><span class="n">consumo_ts</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">)</span>

<span class="c1"># Graficar la serie original y la serie suavizada</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">consumo_ts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">consumo_ts</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Serie Original&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">consumo_ts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">smoothed_series</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Suavización Exponencial (Primer Orden)&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Suavización Exponencial de Primer Orden&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Consumo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/23d55fedc51478a668863473f0c5c2fd2efdd14f1bba61f8559391b64bab7aaa.png" src="_images/23d55fedc51478a668863473f0c5c2fd2efdd14f1bba61f8559391b64bab7aaa.png" />
</div>
</div>
<p>La suavización exponencial es una técnica de modelado de series temporales que se utiliza para reducir el “ruido” en los datos y resaltar patrones importantes como la tendencia y la estacionalidad. La suavización es especialmente útil en escenarios donde los datos tienen variaciones bruscas y a corto plazo que pueden dificultar la identificación de patrones más generales.
Objetivos de la Suavización Exponencial:
Eliminar Fluctuaciones a Corto Plazo: Reduce las variaciones bruscas (ruido) en los datos, lo que permite ver la tendencia general de la serie.
Resaltar Patrones: Facilita la identificación de patrones importantes como la tendencia y la estacionalidad, que son clave para el análisis y predicción.
Predicción: La suavización exponencial es un componente básico de muchos métodos de pronóstico (como el modelo ETS - Error, Trend, Seasonality) y sirve para generar pronósticos basados en la información más reciente de la serie.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Función de suavización exponencial de primer orden</span>
<span class="k">def</span> <span class="nf">firstsmooth</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">ytilde</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ytilde</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lambda_</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">lambda_</span><span class="p">)</span> <span class="o">*</span> <span class="n">start</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
        <span class="n">ytilde</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lambda_</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">lambda_</span><span class="p">)</span> <span class="o">*</span> <span class="n">ytilde</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">ytilde</span><span class="p">)</span>

<span class="c1"># Función para calcular las métricas de precisión: MAPE, MAD y MSD</span>
<span class="k">def</span> <span class="nf">measacc_fs</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">):</span>
    <span class="n">smoothed_series</span> <span class="o">=</span> <span class="n">firstsmooth</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">)</span>
    <span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    
    <span class="c1"># Obtener los valores reales y los valores suavizados (predicciones)</span>
    <span class="n">yh</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">smoothed_series</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Calcular los errores de predicción</span>
    <span class="n">prederr</span> <span class="o">=</span> <span class="n">yh</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">predictions</span><span class="o">.</span><span class="n">values</span>
    
    <span class="c1"># Calcular las métricas</span>
    <span class="n">SSE</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prederr</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">MAPE</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prederr</span> <span class="o">/</span> <span class="n">yh</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">/</span> <span class="n">T</span>
    <span class="n">MAD</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prederr</span><span class="p">))</span> <span class="o">/</span> <span class="n">T</span>
    <span class="n">MSD</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prederr</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">T</span>
    
    <span class="c1"># Retornar las métricas en un DataFrame</span>
    <span class="n">ret1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s2">&quot;SSE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">SSE</span><span class="p">],</span>
        <span class="s2">&quot;MAPE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">MAPE</span><span class="p">],</span>
        <span class="s2">&quot;MAD&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">MAD</span><span class="p">],</span>
        <span class="s2">&quot;MSD&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">MSD</span><span class="p">]</span>
    <span class="p">})</span>
    <span class="n">ret1</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret1</span>

<span class="c1"># Aplicar la función a la serie de tiempo</span>
<span class="n">lambda_</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># Puedes ajustar el valor de lambda según tu análisis anterior</span>
<span class="n">precision_metrics</span> <span class="o">=</span> <span class="n">measacc_fs</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">precision_metrics</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         SSE       MAPE       MAD       MSD
0  1926.7924  83.569205  2.777291  11.89378
</pre></div>
</div>
</div>
</div>
<p>MAPE mide el error promedio entre los valores reales y los valores suavizados como un porcentaje del valor real.
Un MAPE del 83.57% indica que, en promedio, los valores suavizados están desviados de los valores reales en un 83.57%. Esto sugiere que el modelo de suavización no es muy preciso. En general, un MAPE inferior al 10% se considera excelente, mientras que un MAPE superior al 50% indica un ajuste deficiente.
λ seleccionado en este caso, 0.3 no está capturando correctamente el patrón de los datos.
MAD mide la magnitud media de los errores entre los valores reales y los suavizados en las mismas unidades que los datos originales.
Interpretación: Un MAD de 2.777 significa que, en promedio, los errores absolutos entre los valores reales y los valores suavizados son aproximadamente 2.777 unidades. Esto proporciona una medida directa de cuánto se desvían los valores suavizados de los valores reales.
Al igual que SSE, el valor de MAD es más útil cuando se compara con otros modelos o diferentes valores de 𝜆
MSD es el promedio de los errores al cuadrado. Al elevar los errores al cuadrado, la MSD da más peso a los errores grandes, lo que la hace útil para evaluar modelos que deben minimizar errores extremos.
Un MSD de 11.8938 indica una cantidad significativa de error promedio al cuadrado en los datos suavizados. Al igual que SSE y MAD, es más significativo cuando se compara con otros modelos para ver cuál minimiza el error.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.holtwinters</span> <span class="kn">import</span> <span class="n">ExponentialSmoothing</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Función para calcular las métricas de precisión usando Exponential Smoothing</span>
<span class="k">def</span> <span class="nf">measacc_hw</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">):</span>
    <span class="c1"># Aplicar el modelo de suavización exponencial</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">fit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="n">lambda_</span><span class="p">)</span>
    
    <span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">yh</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
    
    <span class="c1"># Obtener los valores ajustados (suavizados)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    
    <span class="c1"># Concatenar los valores suavizados para calcular errores</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">y_pred</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
    <span class="n">prederr</span> <span class="o">=</span> <span class="n">yh</span> <span class="o">-</span> <span class="n">out</span>  <span class="c1"># Errores de predicción</span>
    
    <span class="c1"># Calcular las métricas de precisión</span>
    <span class="n">SSE</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prederr</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">MAPE</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prederr</span> <span class="o">/</span> <span class="n">yh</span><span class="p">))</span> <span class="o">/</span> <span class="n">T</span>
    <span class="n">MAD</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prederr</span><span class="p">))</span> <span class="o">/</span> <span class="n">T</span>
    <span class="n">MSD</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prederr</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">T</span>
    
    <span class="c1"># Retornar las métricas en un DataFrame</span>
    <span class="n">ret1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s2">&quot;SSE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">SSE</span><span class="p">],</span>
        <span class="s2">&quot;MAPE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">MAPE</span><span class="p">],</span>
        <span class="s2">&quot;MAD&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">MAD</span><span class="p">],</span>
        <span class="s2">&quot;MSD&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">MSD</span><span class="p">]</span>
    <span class="p">})</span>
    <span class="n">ret1</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret1</span>

<span class="c1"># Aplicar la función a los datos de consumo mensual con un lambda de 0.3</span>
<span class="n">lambda_</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">precision_metrics_hw</span> <span class="o">=</span> <span class="n">measacc_hw</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">precision_metrics_hw</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           SSE       MAPE      MAD        MSD
0  1955.894229  84.043087  2.87123  12.073421
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Función de suavización exponencial de primer orden</span>
<span class="k">def</span> <span class="nf">firstsmooth</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">ytilde</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ytilde</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lambda_</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">lambda_</span><span class="p">)</span> <span class="o">*</span> <span class="n">start</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
        <span class="n">ytilde</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lambda_</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">lambda_</span><span class="p">)</span> <span class="o">*</span> <span class="n">ytilde</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">ytilde</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Aplicar suavización exponencial de primer orden dos veces para obtener la suavización de segundo orden</span>
<span class="n">lambda_</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">cpi_smooth1</span> <span class="o">=</span> <span class="n">firstsmooth</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">lambda_</span><span class="o">=</span><span class="n">lambda_</span><span class="p">)</span>
<span class="n">cpi_smooth2</span> <span class="o">=</span> <span class="n">firstsmooth</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">cpi_smooth1</span><span class="p">,</span> <span class="n">lambda_</span><span class="o">=</span><span class="n">lambda_</span><span class="p">)</span>

<span class="c1"># Calcular la serie suavizada final (segundo orden)</span>
<span class="n">cpi_hat</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">cpi_smooth1</span> <span class="o">-</span> <span class="n">cpi_smooth2</span>

<span class="c1"># Graficar la serie original y la suavización exponencial de segundo orden</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Consumo Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cpi_hat</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;DES (Segundo Orden) $\lambda=</span><span class="si">{</span><span class="n">lambda_</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Consumo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Suavización Exponencial de Segundo Orden&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a914c76caa7b3fc110f330973dd7d63b0b9cb783287e6fe0749d4ae178168ca1.png" src="_images/a914c76caa7b3fc110f330973dd7d63b0b9cb783287e6fe0749d4ae178168ca1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Función para calcular las métricas de precisión: SSE, MAPE, MAD, MSD para la suavización exponencial de segundo orden</span>
<span class="k">def</span> <span class="nf">measacc_second_order</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">):</span>
    <span class="c1"># Aplicar suavización de segundo orden</span>
    <span class="n">smooth1</span> <span class="o">=</span> <span class="n">firstsmooth</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">)</span>
    <span class="n">smooth2</span> <span class="o">=</span> <span class="n">firstsmooth</span><span class="p">(</span><span class="n">smooth1</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">)</span>
    <span class="n">y_hat</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">smooth1</span> <span class="o">-</span> <span class="n">smooth2</span>
    
    <span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">yh</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
    
    <span class="c1"># Ajustar los valores suavizados para calcular errores</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">y_hat</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
    <span class="n">prederr</span> <span class="o">=</span> <span class="n">yh</span> <span class="o">-</span> <span class="n">out</span>  <span class="c1"># Errores de predicción</span>
    
    <span class="c1"># Calcular las métricas de precisión</span>
    <span class="n">SSE</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prederr</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">MAPE</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prederr</span> <span class="o">/</span> <span class="n">yh</span><span class="p">))</span> <span class="o">/</span> <span class="n">T</span>
    <span class="n">MAD</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prederr</span><span class="p">))</span> <span class="o">/</span> <span class="n">T</span>
    <span class="n">MSD</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prederr</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">T</span>
    
    <span class="c1"># Retornar las métricas en un DataFrame</span>
    <span class="n">ret1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s2">&quot;SSE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">SSE</span><span class="p">],</span>
        <span class="s2">&quot;MAPE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">MAPE</span><span class="p">],</span>
        <span class="s2">&quot;MAD&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">MAD</span><span class="p">],</span>
        <span class="s2">&quot;MSD&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">MSD</span><span class="p">]</span>
    <span class="p">})</span>
    <span class="n">ret1</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret1</span>

<span class="c1"># Calcular las métricas para la suavización exponencial de segundo orden</span>
<span class="n">lambda_</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">metrics_second_order</span> <span class="o">=</span> <span class="n">measacc_second_order</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics_second_order</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           SSE       MAPE     MAD        MSD
0  2082.964312  81.527803  2.8377  12.857804
</pre></div>
</div>
</div>
</div>
<p>MAPE obtenido aquí es 81.53%, que sigue siendo muy alto. Aunque es ligeramente menor que el MAPE de la suavización de primer orden (83.57%), sigue indicando un ajuste deficiente. Un MAPE tan alto significa que, en promedio, las predicciones se desvían del valor real en un 81.53%, lo que indica que el modelo no es preciso.
El valor de MAD es 2.8377, lo cual es un poco más bajo que el valor obtenido con la suavización de primer orden (2.8748). Esto indica que, en promedio, la suavización de segundo orden reduce ligeramente la magnitud del error, aunque la mejora es mínima
La MSD es 12.86, que es ligeramente más alta que la MSD obtenida con la suavización de primer orden (12.37). Esto implica que el modelo de segundo orden no está mejorando en la captura de las fluctuaciones de los datos y, de hecho, puede estar presentando errores más significativos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.holtwinters</span> <span class="kn">import</span> <span class="n">ExponentialSmoothing</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Aplicar suavización exponencial de tercer orden (Holt-Winters) con estacionalidad aditiva</span>
<span class="n">lambda_</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># Parámetro de nivel de suavización</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">seasonal_periods</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="n">lambda_</span><span class="p">)</span>

<span class="c1"># Obtener la serie suavizada</span>
<span class="n">consumo_hat_hw</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">fittedvalues</span>

<span class="c1"># Graficar la serie original y la suavización exponencial de tercer orden (Holt-Winters)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Consumo Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">consumo_hat_hw</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Holt-Winters (Tercer Orden)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Consumo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Suavización Exponencial de Tercer Orden (Holt-Winters)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8aec242027e0be9c890d2234072da20c72756dd05e898085c0c842f50cedfe66.png" src="_images/8aec242027e0be9c890d2234072da20c72756dd05e898085c0c842f50cedfe66.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Función para calcular las métricas de precisión: SSE, MAPE, MAD, MSD para la suavización exponencial de tercer orden (Holt-Winters)</span>
<span class="k">def</span> <span class="nf">measacc_holt_winters</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">fit</span><span class="p">):</span>
    <span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">yh</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
    
    <span class="c1"># Obtener los valores suavizados (fittedvalues)</span>
    <span class="n">y_hat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    
    <span class="c1"># Ajustar los valores suavizados para calcular errores</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">y_hat</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
    <span class="n">prederr</span> <span class="o">=</span> <span class="n">yh</span> <span class="o">-</span> <span class="n">out</span>  <span class="c1"># Errores de predicción</span>
    
    <span class="c1"># Calcular las métricas de precisión</span>
    <span class="n">SSE</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prederr</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">MAPE</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prederr</span> <span class="o">/</span> <span class="n">yh</span><span class="p">))</span> <span class="o">/</span> <span class="n">T</span>
    <span class="n">MAD</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prederr</span><span class="p">))</span> <span class="o">/</span> <span class="n">T</span>
    <span class="n">MSD</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prederr</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">T</span>
    
    <span class="c1"># Retornar las métricas en un DataFrame</span>
    <span class="n">ret1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s2">&quot;SSE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">SSE</span><span class="p">],</span>
        <span class="s2">&quot;MAPE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">MAPE</span><span class="p">],</span>
        <span class="s2">&quot;MAD&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">MAD</span><span class="p">],</span>
        <span class="s2">&quot;MSD&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">MSD</span><span class="p">]</span>
    <span class="p">})</span>
    <span class="n">ret1</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret1</span>

<span class="c1"># Calcular las métricas para la suavización de tercer orden (Holt-Winters)</span>
<span class="n">metrics_holt_winters</span> <span class="o">=</span> <span class="n">measacc_holt_winters</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">fit</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics_holt_winters</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           SSE       MAPE       MAD        MSD
0  1968.476327  82.777039  2.872426  12.151088
</pre></div>
</div>
</div>
</div>
<p>El valor del MAPE es 82.78%, lo que indica que las predicciones se desvían del valor real en un 82.78%, en promedio. Este valor es ligeramente menor que los obtenidos en las suavizaciones de primer (83.57%) y segundo orden (81.53%). Sin embargo, sigue siendo muy alto para considerarse un buen ajuste (un MAPE por debajo del 10% se considera excelente).
El valor de MAD es 2.87, muy similar a los valores obtenidos con las suavizaciones anteriores (primer y segundo orden). Esto sugiere que, en promedio, el error absoluto entre los valores reales y los suavizados se ha mantenido constante, lo que indica que la mejora en el ajuste es mínima.
La MSD es 12.15, que es más baja que la de las suavizaciones de primer (12.37) y segundo orden (12.86). Esto muestra que el modelo de tercer orden (Holt-Winters) ha logrado reducir los errores más significativos, aunque la mejora es leve.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.holtwinters</span> <span class="kn">import</span> <span class="n">ExponentialSmoothing</span>

<span class="c1"># Función para calcular el SSE utilizando la suavización de tercer orden (Holt-Winters)</span>
<span class="k">def</span> <span class="nf">sse_holt_winters</span><span class="p">(</span><span class="n">lambda_</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">seasonal_periods</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">fit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="n">lambda_</span><span class="p">)</span>
    <span class="n">sse</span> <span class="o">=</span> <span class="n">measacc_holt_winters</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">fit</span><span class="p">)[</span><span class="s1">&#39;SSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">sse</span>

<span class="c1"># Vector de valores lambda para probar</span>
<span class="n">lambda_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Calcular el SSE para cada valor de lambda</span>
<span class="n">sse_vec</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
<span class="k">for</span> <span class="n">lambda_</span> <span class="ow">in</span> <span class="n">lambda_vec</span><span class="p">:</span>
    <span class="n">sse_vec</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">sse_vec</span><span class="p">)]</span> <span class="o">=</span> <span class="n">sse_holt_winters</span><span class="p">(</span><span class="n">lambda_</span><span class="p">)</span>

<span class="c1"># Encontrar el valor óptimo de lambda</span>
<span class="n">opt_lambda</span> <span class="o">=</span> <span class="n">lambda_vec</span><span class="p">[</span><span class="n">sse_vec</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>

<span class="c1"># Graficar SSE vs. lambda</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lambda_vec</span><span class="p">,</span> <span class="n">sse_vec</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;$SSE$ vs. $\lambda$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$\lambda$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$SSE$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">opt_lambda</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$\lambda$ óptimo = </span><span class="si">{</span><span class="n">opt_lambda</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;El valor óptimo de lambda es: </span><span class="si">{</span><span class="n">opt_lambda</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/eed7d34afe6ab7bdb870028090b2f862c5d46429d2865e3d05468ffcc32fd8b2.png" src="_images/eed7d34afe6ab7bdb870028090b2f862c5d46429d2865e3d05468ffcc32fd8b2.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>El valor óptimo de lambda es: 0.2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.holtwinters</span> <span class="kn">import</span> <span class="n">ExponentialSmoothing</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Aplicar suavización exponencial de tercer orden (Holt-Winters) con el nuevo valor óptimo de lambda = 0.2</span>
<span class="n">lambda_opt</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># Nuevo valor óptimo de lambda</span>
<span class="n">model_opt</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">seasonal_periods</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">fit_opt</span> <span class="o">=</span> <span class="n">model_opt</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="n">lambda_opt</span><span class="p">)</span>

<span class="c1"># Obtener la serie suavizada con el nuevo valor de lambda</span>
<span class="n">consumo_hat_hw_opt</span> <span class="o">=</span> <span class="n">fit_opt</span><span class="o">.</span><span class="n">fittedvalues</span>

<span class="c1"># Graficar la serie original y la suavización exponencial de tercer orden (Holt-Winters) con el nuevo lambda</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Consumo Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">consumo_hat_hw_opt</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Holt-Winters (Tercer Orden) $\lambda=</span><span class="si">{</span><span class="n">lambda_opt</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Consumo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Suavización Exponencial de Tercer Orden (Holt-Winters) con Lambda Óptimo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Calcular las métricas para la suavización de tercer orden (Holt-Winters) con el nuevo lambda</span>
<span class="n">metrics_holt_winters_opt</span> <span class="o">=</span> <span class="n">measacc_holt_winters</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">fit_opt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics_holt_winters_opt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/98b572035840b028030852c81ce4d43495cec8049931c7f7412b8aab41469507.png" src="_images/98b572035840b028030852c81ce4d43495cec8049931c7f7412b8aab41469507.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           SSE       MAPE       MAD        MSD
0  1958.267448  83.730022  2.855451  12.088071
</pre></div>
</div>
</div>
</div>
<p>Al ajustar el valor de 𝜆 a 0.2, observamos solo mejoras marginales en algunas métricas (SSE y MSD) y un ligero empeoramiento en el MAPE. Esto indica que el modelo Holt-Winters con suavización exponencial no está logrando capturar los patrones de la serie temporal de manera significativa.
El MAPE sigue siendo extremadamente alto (83.73%), lo que señala que el modelo no es adecuado para predecir los datos con precisión. La persistencia de errores altos sugiere que hay componentes o comportamientos en la serie que la suavización exponencial no puede modelar correctamente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.holtwinters</span> <span class="kn">import</span> <span class="n">ExponentialSmoothing</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Aplicar suavización exponencial de tercer orden (Holt-Winters) con tendencia multiplicativa y estacionalidad multiplicativa</span>
<span class="n">model_multiplicative</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;mul&#39;</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="s1">&#39;mul&#39;</span><span class="p">,</span> <span class="n">seasonal_periods</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">fit_multiplicative</span> <span class="o">=</span> <span class="n">model_multiplicative</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="n">lambda_opt</span><span class="p">)</span>

<span class="c1"># Obtener la serie suavizada con el nuevo ajuste</span>
<span class="n">consumo_hat_hw_multiplicative</span> <span class="o">=</span> <span class="n">fit_multiplicative</span><span class="o">.</span><span class="n">fittedvalues</span>

<span class="c1"># Graficar la serie original y la suavización exponencial de tercer orden (Holt-Winters) con tendencia y estacionalidad multiplicativa</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Consumo Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">consumo_hat_hw_multiplicative</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Holt-Winters (Multiplicativo)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Consumo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Suavización Exponencial de Tercer Orden (Holt-Winters) con Tendencia y Estacionalidad Multiplicativa&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Calcular las métricas para la suavización de tercer orden (Holt-Winters) con tendencia y estacionalidad multiplicativa</span>
<span class="n">metrics_holt_winters_multiplicative</span> <span class="o">=</span> <span class="n">measacc_holt_winters</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">fit_multiplicative</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics_holt_winters_multiplicative</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2c005b2aa1c15f2fcb67f64ac33167c75f83ac3a43313a534f26dc62a77fdace.png" src="_images/2c005b2aa1c15f2fcb67f64ac33167c75f83ac3a43313a534f26dc62a77fdace.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           SSE       MAPE       MAD        MSD
0  1943.318971  81.349113  2.837686  11.995796
</pre></div>
</div>
</div>
</div>
<p>La suavización exponencial de tercer orden (Holt-Winters) con tendencia y estacionalidad multiplicativa ha mostrado una ligera mejora en todas las métricas (SSE, MAPE, MAD, y MSD) en comparación con las configuraciones aditivas. Esto sugiere que el componente multiplicativo es más adecuado para la estructura de los datos, ya que captura mejor la variabilidad proporcional.
A pesar de la mejora, el MAPE sigue siendo muy alto (81.35%), lo que indica que el modelo todavía no es adecuado para una predicción precisa. La presencia de errores significativos sugiere que los datos tienen características más complejas, como estacionalidad cambiante, patrones no lineales, o presencia de ruido que la suavización exponencial no puede modelar completamente.</p>
<p>El modelo Holt-Winters con componentes multiplicativos ha mostrado una mejora ligera, reduciendo las métricas de error, especialmente el SSE y MSD. Sin embargo, el MAPE sigue siendo demasiado alto, lo que indica un ajuste deficiente. Para obtener predicciones más precisas, se recomienda probar modelos autorregresivos integrados de media movil.</p>
</section>
<section id="modelo-autorregresivo-integral-de-media-movil">
<h1>MODELO AUTORREGRESIVO INTEGRAL DE MEDIA MOVIL<a class="headerlink" href="#modelo-autorregresivo-integral-de-media-movil" title="Link to this heading">#</a></h1>
<p>Inicialmente se obtienen las funciones de autocorrelacion y volvemos a hacer la prueba de Dickey-Fuller para validar estacionalidad (realiazada anteriormente cuando se validaron modelos de suavizado)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">adfuller</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Paso 1: Realizar Análisis Exploratorio: Graficar ACF y PACF</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Función de Autocorrelación (ACF)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Autocorrelation Function (ACF)&#39;</span><span class="p">)</span>

<span class="c1"># Función de Autocorrelación Parcial (PACF)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plot_pacf</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Partial Autocorrelation Function (PACF)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Paso 2: Prueba de Estacionariedad - Prueba de Dickey-Fuller Aumentada</span>
<span class="n">adf_result</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">)</span>
<span class="n">adf_p_value</span> <span class="o">=</span> <span class="n">adf_result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">is_stationary</span> <span class="o">=</span> <span class="n">adf_p_value</span> <span class="o">&lt;</span> <span class="mf">0.05</span>

<span class="c1"># Paso 3: Aplicar Diferenciación si la serie no es estacionaria</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">is_stationary</span><span class="p">:</span>
    <span class="n">consumo_ts_diff</span> <span class="o">=</span> <span class="n">consumo_ts</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="c1"># Repetir la prueba de Dickey-Fuller en los datos diferenciados</span>
    <span class="n">adf_result_diff</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">consumo_ts_diff</span><span class="p">)</span>
    <span class="n">adf_p_value_diff</span> <span class="o">=</span> <span class="n">adf_result_diff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Graficar ACF y PACF para la serie diferenciada</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plot_acf</span><span class="p">(</span><span class="n">consumo_ts_diff</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">())</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ACF (Diferenciada)&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plot_pacf</span><span class="p">(</span><span class="n">consumo_ts_diff</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">())</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PACF (Diferenciada)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="p">(</span><span class="n">adf_p_value</span><span class="p">,</span> <span class="n">is_stationary</span><span class="p">,</span> <span class="n">adf_p_value_diff</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_stationary</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7f994002b3496a495a46e51e22a1c0f570f5215d3d9e33423b5f7f6ebfb015e7.png" src="_images/7f994002b3496a495a46e51e22a1c0f570f5215d3d9e33423b5f7f6ebfb015e7.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(9.212302027900123e-07, True, None)
</pre></div>
</div>
</div>
</div>
<p>La gráfica ACF muestra autocorrelaciones de la serie temporal en diferentes rezagos (lags).
Hay una fuerte correlación en el primer rezago (lag 1) con un valor cercano a 1. Esto indica que la serie tiene una alta autocorrelación en el corto plazo.
Los rezagos posteriores (hasta alrededor del lag 5) también muestran valores positivos significativos, aunque decrecientes, que permanecen por encima de las líneas de significancia. Esto indica una posible dependencia temporal en la serie.
A partir de aproximadamente el lag 6, las correlaciones disminuyen y oscilan alrededor de cero, indicando que la autocorrelación se reduce y tiende a ser ruido blanco.</p>
<p>La gráfica PACF muestra la correlación parcial entre una observación y su rezago, eliminando el efecto de los rezagos intermedios.
La correlación parcial es fuerte en el primer rezago (lag 1) y disminuye rápidamente después del primer lag.
Los valores de la PACF en los rezagos posteriores son relativamente pequeños y caen dentro de las bandas de confianza, lo que indica que la influencia significativa de la serie se concentra en los primeros lags.</p>
<p><img alt="image.png" src="attachment:image.png" /></p>
<p>Modelo Sugerido</p>
<p>Revisando la literatura vemos que la grafica ACF tiene un corte en el rezago 9 aproximadamente pero despues tiene un comportamiento sinusoide amortiguado, por lo tanto podria considerarse un modelo AR o ARMA. (Tenemos estacionalidad)
La grafica PACF tiene un corte y posteriormente un comportamiento sinusoidal, lo que indica q el mejor modelo  seria un ARMA.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.arima.model</span> <span class="kn">import</span> <span class="n">ARIMA</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>

<span class="c1"># Función para calcular las métricas de precisión: SSE, MAPE, MAD, MSD para un modelo ARMA</span>
<span class="k">def</span> <span class="nf">arima_metrics</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">model_fit</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model_fit</span><span class="o">.</span><span class="n">fittedvalues</span>
        <span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

        <span class="c1"># Ajustar los valores suavizados para calcular errores</span>
        <span class="n">prederr</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># Calcular las métricas de precisión</span>
        <span class="n">SSE</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prederr</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">MAPE</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prederr</span> <span class="o">/</span> <span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">/</span> <span class="n">T</span>
        <span class="n">MAD</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prederr</span><span class="p">))</span> <span class="o">/</span> <span class="n">T</span>
        <span class="n">MSD</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

        <span class="c1"># Retornar las métricas en un DataFrame</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span>
            <span class="s2">&quot;SSE&quot;</span><span class="p">:</span> <span class="n">SSE</span><span class="p">,</span>
            <span class="s2">&quot;MAPE&quot;</span><span class="p">:</span> <span class="n">MAPE</span><span class="p">,</span>
            <span class="s2">&quot;MAD&quot;</span><span class="p">:</span> <span class="n">MAD</span><span class="p">,</span>
            <span class="s2">&quot;MSD&quot;</span><span class="p">:</span> <span class="n">MSD</span>
        <span class="p">})</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error calculating metrics: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="c1"># Probar diferentes combinaciones de valores p y q para el modelo ARMA basado en los gráficos ACF y PACF</span>
<span class="n">p_values</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># Consideramos valores de p desde 1 hasta 9 basados en el corte observado en ACF</span>
<span class="n">q_values</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>   <span class="c1"># Probamos valores de q desde 1 hasta 3 basados en el patrón sinusoidal observado</span>

<span class="c1"># Almacenar resultados de las métricas para cada combinación de p y q</span>
<span class="n">arma_results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Iterar sobre todas las combinaciones de p y q</span>
<span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="n">p_values</span><span class="p">,</span> <span class="n">q_values</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Ajustar el modelo ARMA(p, q)</span>
        <span class="n">model_arma</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span>  <span class="c1"># d=0 ya que la serie es estacionaria</span>
        <span class="n">fit_arma</span> <span class="o">=</span> <span class="n">model_arma</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
        
        <span class="c1"># Calcular las métricas de precisión</span>
        <span class="n">metrics_arma</span> <span class="o">=</span> <span class="n">arima_metrics</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">fit_arma</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">metrics_arma</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">metrics_arma</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>
            <span class="n">metrics_arma</span><span class="p">[</span><span class="s2">&quot;q&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span>

            <span class="c1"># Almacenar resultados</span>
            <span class="n">arma_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metrics_arma</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error fitting ARMA(</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">q</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">continue</span>

<span class="c1"># Crear un DataFrame para visualizar los resultados</span>
<span class="n">arma_results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">arma_results</span><span class="p">)</span>

<span class="c1"># Validar si hay resultados para ordenar</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">arma_results_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="c1"># Mostrar los resultados ordenados por SSE para encontrar el mejor modelo</span>
    <span class="n">arma_results_df_sorted</span> <span class="o">=</span> <span class="n">arma_results_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;SSE&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">arma_results_df_sorted</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No se obtuvieron resultados para los modelos ARMA probados.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>            SSE       MAPE       MAD        MSD    p    q
26  1642.700190  83.434612  2.553261  10.140125  9.0  3.0
23  1657.725125  82.397740  2.558603  10.232871  8.0  3.0
25  1658.664035  84.926972  2.560359  10.238667  9.0  2.0
20  1660.337416  82.549468  2.560674  10.248996  7.0  3.0
14  1691.447757  82.482779  2.582038  10.441036  5.0  3.0
21  1694.848061  83.882849  2.600398  10.462025  8.0  1.0
22  1695.167984  84.048791  2.601900  10.464000  8.0  2.0
19  1695.185793  84.083010  2.601326  10.464110  7.0  2.0
18  1695.764230  83.952975  2.600743  10.467680  7.0  1.0
17  1695.774483  83.960717  2.602042  10.467744  6.0  3.0
15  1695.799345  83.914182  2.601432  10.467897  6.0  1.0
13  1695.843571  83.878931  2.601731  10.468170  5.0  2.0
16  1695.944939  84.088909  2.597252  10.468796  6.0  2.0
8   1696.128235  85.473687  2.618584  10.469927  3.0  3.0
12  1696.159624  83.961053  2.598110  10.470121  5.0  1.0
10  1706.309892  84.649322  2.586289  10.532777  4.0  2.0
11  1707.336292  85.980736  2.613886  10.539113  4.0  3.0
24  1715.754040  84.998494  2.614959  10.591074  9.0  1.0
5   1742.772567  85.993733  2.636879  10.757855  2.0  3.0
9   1742.822706  86.047573  2.638709  10.758165  4.0  1.0
7   1742.951708  86.001073  2.636802  10.758961  3.0  2.0
6   1743.031654  85.978568  2.636228  10.759455  3.0  1.0
4   1743.185120  86.023535  2.636916  10.760402  2.0  2.0
2   1743.417578  85.908492  2.636011  10.761837  1.0  3.0
3   1744.058160  86.016031  2.635648  10.765791  2.0  1.0
1   1745.800205  85.994481  2.639610  10.776544  1.0  2.0
0   1757.197408  85.955456  2.665049  10.846898  1.0  1.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.statespace.sarimax</span> <span class="kn">import</span> <span class="n">SARIMAX</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Función para calcular las métricas de precisión: SSE, MAPE, MAD, MSD para un modelo SARIMA</span>
<span class="k">def</span> <span class="nf">arima_metrics</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">model_fit</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model_fit</span><span class="o">.</span><span class="n">fittedvalues</span>
        <span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

        <span class="c1"># Ajustar los valores suavizados para calcular errores</span>
        <span class="n">prederr</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># Calcular las métricas de precisión</span>
        <span class="n">SSE</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prederr</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">MAPE</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prederr</span> <span class="o">/</span> <span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">/</span> <span class="n">T</span>
        <span class="n">MAD</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prederr</span><span class="p">))</span> <span class="o">/</span> <span class="n">T</span>
        <span class="n">MSD</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

        <span class="c1"># Retornar las métricas en un DataFrame</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span>
            <span class="s2">&quot;SSE&quot;</span><span class="p">:</span> <span class="n">SSE</span><span class="p">,</span>
            <span class="s2">&quot;MAPE&quot;</span><span class="p">:</span> <span class="n">MAPE</span><span class="p">,</span>
            <span class="s2">&quot;MAD&quot;</span><span class="p">:</span> <span class="n">MAD</span><span class="p">,</span>
            <span class="s2">&quot;MSD&quot;</span><span class="p">:</span> <span class="n">MSD</span>
        <span class="p">})</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error calculating metrics: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="c1"># Definir los posibles valores de p, d, q y P, D, Q (estacionales)</span>
<span class="n">p_values</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">d_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># Diferenciación no estacional</span>
<span class="n">q_values</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">P_values</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">D_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># Diferenciación estacional</span>
<span class="n">Q_values</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">seasonal_period</span> <span class="o">=</span> <span class="mi">12</span>  <span class="c1"># Asumimos estacionalidad anual (mensual en datos anuales)</span>

<span class="c1"># Almacenar resultados de las métricas para cada combinación de parámetros</span>
<span class="n">sarima_results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Iterar sobre todas las combinaciones posibles de parámetros</span>
<span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">Q</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="n">p_values</span><span class="p">,</span> <span class="n">d_values</span><span class="p">,</span> <span class="n">q_values</span><span class="p">,</span> <span class="n">P_values</span><span class="p">,</span> <span class="n">D_values</span><span class="p">,</span> <span class="n">Q_values</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Ajustar el modelo SARIMA(p, d, q)(P, D, Q, 12)</span>
        <span class="n">model_sarima</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">seasonal_period</span><span class="p">))</span>
        <span class="n">fit_sarima</span> <span class="o">=</span> <span class="n">model_sarima</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="c1"># Calcular las métricas de precisión</span>
        <span class="n">metrics_sarima</span> <span class="o">=</span> <span class="n">arima_metrics</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">fit_sarima</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">metrics_sarima</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">metrics_sarima</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>
            <span class="n">metrics_sarima</span><span class="p">[</span><span class="s2">&quot;d&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span>
            <span class="n">metrics_sarima</span><span class="p">[</span><span class="s2">&quot;q&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span>
            <span class="n">metrics_sarima</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span>
            <span class="n">metrics_sarima</span><span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">D</span>
            <span class="n">metrics_sarima</span><span class="p">[</span><span class="s2">&quot;Q&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Q</span>

            <span class="c1"># Almacenar resultados</span>
            <span class="n">sarima_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metrics_sarima</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error fitting SARIMA(</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">q</span><span class="si">}</span><span class="s2">)x(</span><span class="si">{</span><span class="n">P</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">D</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">Q</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">seasonal_period</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">continue</span>

<span class="c1"># Crear un DataFrame para visualizar los resultados</span>
<span class="n">sarima_results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sarima_results</span><span class="p">)</span>

<span class="c1"># Validar si hay resultados para ordenar</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">sarima_results_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="c1"># Mostrar los resultados ordenados por SSE para encontrar el mejor modelo</span>
    <span class="n">sarima_results_df_sorted</span> <span class="o">=</span> <span class="n">sarima_results_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;SSE&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">sarima_results_df_sorted</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No se obtuvieron resultados para los modelos SARIMA probados.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">38</span><span class="p">],</span> <span class="n">line</span> <span class="mi">48</span>
<span class="g g-Whitespace">     </span><span class="mi">45</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">46</span>     <span class="c1"># Ajustar el modelo SARIMA(p, d, q)(P, D, Q, 12)</span>
<span class="g g-Whitespace">     </span><span class="mi">47</span>     <span class="n">model_sarima</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">seasonal_period</span><span class="p">))</span>
<span class="ne">---&gt; </span><span class="mi">48</span>     <span class="n">fit_sarima</span> <span class="o">=</span> <span class="n">model_sarima</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">50</span>     <span class="c1"># Calcular las métricas de precisión</span>
<span class="g g-Whitespace">     </span><span class="mi">51</span>     <span class="n">metrics_sarima</span> <span class="o">=</span> <span class="n">arima_metrics</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">,</span> <span class="n">fit_sarima</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\statsmodels\tsa\statespace\mlemodel.py:705,</span> in <span class="ni">MLEModel.fit</span><span class="nt">(self, start_params, transformed, includes_fixed, cov_type, cov_kwds, method, maxiter, full_output, disp, callback, return_params, optim_score, optim_complex_step, optim_hessian, flags, low_memory, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">703</span>         <span class="n">flags</span><span class="p">[</span><span class="s1">&#39;hessian_method&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">optim_hessian</span>
<span class="g g-Whitespace">    </span><span class="mi">704</span>     <span class="n">fargs</span> <span class="o">=</span> <span class="p">(</span><span class="n">flags</span><span class="p">,)</span>
<span class="ne">--&gt; </span><span class="mi">705</span>     <span class="n">mlefit</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">start_params</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">706</span>                          <span class="n">fargs</span><span class="o">=</span><span class="n">fargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">707</span>                          <span class="n">maxiter</span><span class="o">=</span><span class="n">maxiter</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">708</span>                          <span class="n">full_output</span><span class="o">=</span><span class="n">full_output</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">709</span>                          <span class="n">disp</span><span class="o">=</span><span class="n">disp</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">710</span>                          <span class="n">skip_hessian</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">712</span> <span class="c1"># Just return the fitted parameters if requested</span>
<span class="g g-Whitespace">    </span><span class="mi">713</span> <span class="k">if</span> <span class="n">return_params</span><span class="p">:</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\statsmodels\base\model.py:566,</span> in <span class="ni">LikelihoodModel.fit</span><span class="nt">(self, start_params, method, maxiter, full_output, disp, fargs, callback, retall, skip_hessian, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">563</span>     <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;use_t&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">565</span> <span class="n">optimizer</span> <span class="o">=</span> <span class="n">Optimizer</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">566</span> <span class="n">xopt</span><span class="p">,</span> <span class="n">retvals</span><span class="p">,</span> <span class="n">optim_settings</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">_fit</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">start_params</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">567</span>                                                <span class="n">fargs</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">568</span>                                                <span class="n">hessian</span><span class="o">=</span><span class="n">hess</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">569</span>                                                <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">570</span>                                                <span class="n">disp</span><span class="o">=</span><span class="n">disp</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">571</span>                                                <span class="n">maxiter</span><span class="o">=</span><span class="n">maxiter</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">572</span>                                                <span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">573</span>                                                <span class="n">retall</span><span class="o">=</span><span class="n">retall</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">574</span>                                                <span class="n">full_output</span><span class="o">=</span><span class="n">full_output</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">575</span> <span class="c1"># Restore cov_type, cov_kwds and use_t</span>
<span class="g g-Whitespace">    </span><span class="mi">576</span> <span class="n">optim_settings</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\statsmodels\base\optimizer.py:243,</span> in <span class="ni">Optimizer._fit</span><span class="nt">(self, objective, gradient, start_params, fargs, kwargs, hessian, method, maxiter, full_output, disp, callback, retall)</span>
<span class="g g-Whitespace">    </span><span class="mi">240</span>     <span class="n">fit_funcs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">extra_fit_funcs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">242</span> <span class="n">func</span> <span class="o">=</span> <span class="n">fit_funcs</span><span class="p">[</span><span class="n">method</span><span class="p">]</span>
<span class="ne">--&gt; </span><span class="mi">243</span> <span class="n">xopt</span><span class="p">,</span> <span class="n">retvals</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">gradient</span><span class="p">,</span> <span class="n">start_params</span><span class="p">,</span> <span class="n">fargs</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">244</span>                      <span class="n">disp</span><span class="o">=</span><span class="n">disp</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="n">maxiter</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">245</span>                      <span class="n">retall</span><span class="o">=</span><span class="n">retall</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="n">full_output</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">246</span>                      <span class="n">hess</span><span class="o">=</span><span class="n">hessian</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">248</span> <span class="n">optim_settings</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;optimizer&#39;</span><span class="p">:</span> <span class="n">method</span><span class="p">,</span> <span class="s1">&#39;start_params&#39;</span><span class="p">:</span> <span class="n">start_params</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">249</span>                   <span class="s1">&#39;maxiter&#39;</span><span class="p">:</span> <span class="n">maxiter</span><span class="p">,</span> <span class="s1">&#39;full_output&#39;</span><span class="p">:</span> <span class="n">full_output</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">250</span>                   <span class="s1">&#39;disp&#39;</span><span class="p">:</span> <span class="n">disp</span><span class="p">,</span> <span class="s1">&#39;fargs&#39;</span><span class="p">:</span> <span class="n">fargs</span><span class="p">,</span> <span class="s1">&#39;callback&#39;</span><span class="p">:</span> <span class="n">callback</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">251</span>                   <span class="s1">&#39;retall&#39;</span><span class="p">:</span> <span class="n">retall</span><span class="p">,</span> <span class="s2">&quot;extra_fit_funcs&quot;</span><span class="p">:</span> <span class="n">extra_fit_funcs</span><span class="p">}</span>
<span class="g g-Whitespace">    </span><span class="mi">252</span> <span class="n">optim_settings</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\statsmodels\base\optimizer.py:660,</span> in <span class="ni">_fit_lbfgs</span><span class="nt">(f, score, start_params, fargs, kwargs, disp, maxiter, callback, retall, full_output, hess)</span>
<span class="g g-Whitespace">    </span><span class="mi">657</span> <span class="k">elif</span> <span class="n">approx_grad</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">658</span>     <span class="n">func</span> <span class="o">=</span> <span class="n">f</span>
<span class="ne">--&gt; </span><span class="mi">660</span> <span class="n">retvals</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fmin_l_bfgs_b</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">start_params</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="n">maxiter</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">661</span>                                  <span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">fargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">662</span>                                  <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="n">disp</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">663</span>                                  <span class="o">**</span><span class="n">extra_kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">665</span> <span class="k">if</span> <span class="n">full_output</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">666</span>     <span class="n">xopt</span><span class="p">,</span> <span class="n">fopt</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">retvals</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\scipy\optimize\_lbfgsb_py.py:199,</span> in <span class="ni">fmin_l_bfgs_b</span><span class="nt">(func, x0, fprime, args, approx_grad, bounds, m, factr, pgtol, epsilon, iprint, maxfun, maxiter, disp, callback, maxls)</span>
<span class="g g-Whitespace">    </span><span class="mi">187</span> <span class="n">callback</span> <span class="o">=</span> <span class="n">_wrap_callback</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">188</span> <span class="n">opts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;disp&#39;</span><span class="p">:</span> <span class="n">disp</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">189</span>         <span class="s1">&#39;iprint&#39;</span><span class="p">:</span> <span class="n">iprint</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">190</span>         <span class="s1">&#39;maxcor&#39;</span><span class="p">:</span> <span class="n">m</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">196</span>         <span class="s1">&#39;callback&#39;</span><span class="p">:</span> <span class="n">callback</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">197</span>         <span class="s1">&#39;maxls&#39;</span><span class="p">:</span> <span class="n">maxls</span><span class="p">}</span>
<span class="ne">--&gt; </span><span class="mi">199</span> <span class="n">res</span> <span class="o">=</span> <span class="n">_minimize_lbfgsb</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">jac</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">200</span>                        <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">201</span> <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;grad&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;jac&#39;</span><span class="p">],</span>
<span class="g g-Whitespace">    </span><span class="mi">202</span>      <span class="s1">&#39;task&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">],</span>
<span class="g g-Whitespace">    </span><span class="mi">203</span>      <span class="s1">&#39;funcalls&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;nfev&#39;</span><span class="p">],</span>
<span class="g g-Whitespace">    </span><span class="mi">204</span>      <span class="s1">&#39;nit&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;nit&#39;</span><span class="p">],</span>
<span class="g g-Whitespace">    </span><span class="mi">205</span>      <span class="s1">&#39;warnflag&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]}</span>
<span class="g g-Whitespace">    </span><span class="mi">206</span> <span class="n">f</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;fun&#39;</span><span class="p">]</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\scipy\optimize\_lbfgsb_py.py:365,</span> in <span class="ni">_minimize_lbfgsb</span><span class="nt">(fun, x0, args, jac, bounds, disp, maxcor, ftol, gtol, eps, maxfun, maxiter, iprint, callback, maxls, finite_diff_rel_step, **unknown_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">359</span> <span class="n">task_str</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">360</span> <span class="k">if</span> <span class="n">task_str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;FG&#39;</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">361</span>     <span class="c1"># The minimization routine wants f and g at the current x.</span>
<span class="g g-Whitespace">    </span><span class="mi">362</span>     <span class="c1"># Note that interruptions due to maxfun are postponed</span>
<span class="g g-Whitespace">    </span><span class="mi">363</span>     <span class="c1"># until the completion of the current minimization iteration.</span>
<span class="g g-Whitespace">    </span><span class="mi">364</span>     <span class="c1"># Overwrite f and g:</span>
<span class="ne">--&gt; </span><span class="mi">365</span>     <span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">func_and_grad</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">366</span> <span class="k">elif</span> <span class="n">task_str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;NEW_X&#39;</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">367</span>     <span class="c1"># new iteration</span>
<span class="g g-Whitespace">    </span><span class="mi">368</span>     <span class="n">n_iterations</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\scipy\optimize\_differentiable_functions.py:286,</span> in <span class="ni">ScalarFunction.fun_and_grad</span><span class="nt">(self, x)</span>
<span class="g g-Whitespace">    </span><span class="mi">284</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_update_x_impl</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">285</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_fun</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">286</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_grad</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">287</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\scipy\optimize\_differentiable_functions.py:256,</span> in <span class="ni">ScalarFunction._update_grad</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">254</span> <span class="k">def</span> <span class="nf">_update_grad</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">255</span>     <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_updated</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">256</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_update_grad_impl</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">257</span>         <span class="bp">self</span><span class="o">.</span><span class="n">g_updated</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\scipy\optimize\_differentiable_functions.py:173,</span> in <span class="ni">ScalarFunction.__init__.&lt;locals&gt;.update_grad</span><span class="nt">()</span>
<span class="g g-Whitespace">    </span><span class="mi">171</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_fun</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">172</span> <span class="bp">self</span><span class="o">.</span><span class="n">ngev</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="ne">--&gt; </span><span class="mi">173</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="n">approx_derivative</span><span class="p">(</span><span class="n">fun_wrapped</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">f0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">174</span>                            <span class="o">**</span><span class="n">finite_diff_options</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\scipy\optimize\_numdiff.py:505,</span> in <span class="ni">approx_derivative</span><span class="nt">(fun, x0, method, rel_step, abs_step, f0, bounds, sparsity, as_linear_operator, args, kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">502</span>     <span class="n">use_one_sided</span> <span class="o">=</span> <span class="kc">False</span>
<span class="g g-Whitespace">    </span><span class="mi">504</span> <span class="k">if</span> <span class="n">sparsity</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">505</span>     <span class="k">return</span> <span class="n">_dense_difference</span><span class="p">(</span><span class="n">fun_wrapped</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">506</span>                              <span class="n">use_one_sided</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">507</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">508</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">issparse</span><span class="p">(</span><span class="n">sparsity</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">sparsity</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\scipy\optimize\_numdiff.py:576,</span> in <span class="ni">_dense_difference</span><span class="nt">(fun, x0, f0, h, use_one_sided, method)</span>
<span class="g g-Whitespace">    </span><span class="mi">574</span>     <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">h_vecs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">575</span>     <span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">x0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># Recompute dx as exactly representable number.</span>
<span class="ne">--&gt; </span><span class="mi">576</span>     <span class="n">df</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">f0</span>
<span class="g g-Whitespace">    </span><span class="mi">577</span> <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;3-point&#39;</span> <span class="ow">and</span> <span class="n">use_one_sided</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
<span class="g g-Whitespace">    </span><span class="mi">578</span>     <span class="n">x1</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">h_vecs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\scipy\optimize\_numdiff.py:456,</span> in <span class="ni">approx_derivative.&lt;locals&gt;.fun_wrapped</span><span class="nt">(x)</span>
<span class="g g-Whitespace">    </span><span class="mi">455</span> <span class="k">def</span> <span class="nf">fun_wrapped</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">456</span>     <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">457</span>     <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">458</span>         <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;`fun` return value has &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">459</span>                            <span class="s2">&quot;more than 1 dimension.&quot;</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\scipy\optimize\_differentiable_functions.py:137,</span> in <span class="ni">ScalarFunction.__init__.&lt;locals&gt;.fun_wrapped</span><span class="nt">(x)</span>
<span class="g g-Whitespace">    </span><span class="mi">133</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfev</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="g g-Whitespace">    </span><span class="mi">134</span> <span class="c1"># Send a copy because the user may overwrite it.</span>
<span class="g g-Whitespace">    </span><span class="mi">135</span> <span class="c1"># Overwriting results in undefined behaviour because</span>
<span class="g g-Whitespace">    </span><span class="mi">136</span> <span class="c1"># fun(self.x) will change self.x, with the two no longer linked.</span>
<span class="ne">--&gt; </span><span class="mi">137</span> <span class="n">fx</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">138</span> <span class="c1"># Make sure the function returns a true scalar</span>
<span class="g g-Whitespace">    </span><span class="mi">139</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">fx</span><span class="p">):</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\statsmodels\base\model.py:534,</span> in <span class="ni">LikelihoodModel.fit.&lt;locals&gt;.f</span><span class="nt">(params, *args)</span>
<span class="g g-Whitespace">    </span><span class="mi">533</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">534</span>     <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">loglike</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">/</span> <span class="n">nobs</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\statsmodels\tsa\statespace\mlemodel.py:940,</span> in <span class="ni">MLEModel.loglike</span><span class="nt">(self, params, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">937</span> <span class="k">if</span> <span class="n">complex_step</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">938</span>     <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;inversion_method&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">INVERT_UNIVARIATE</span> <span class="o">|</span> <span class="n">SOLVE_LU</span>
<span class="ne">--&gt; </span><span class="mi">940</span> <span class="n">loglike</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ssm</span><span class="o">.</span><span class="n">loglike</span><span class="p">(</span><span class="n">complex_step</span><span class="o">=</span><span class="n">complex_step</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">942</span> <span class="c1"># Koopman, Shephard, and Doornik recommend maximizing the average</span>
<span class="g g-Whitespace">    </span><span class="mi">943</span> <span class="c1"># likelihood to avoid scale issues, but the averaging is done</span>
<span class="g g-Whitespace">    </span><span class="mi">944</span> <span class="c1"># automatically in the base model `fit` method</span>
<span class="g g-Whitespace">    </span><span class="mi">945</span> <span class="k">return</span> <span class="n">loglike</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\statsmodels\tsa\statespace\kalman_filter.py:1001,</span> in <span class="ni">KalmanFilter.loglike</span><span class="nt">(self, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">985</span><span class="w"> </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">986</span><span class="sd"> Calculate the loglikelihood associated with the statespace model.</span>
<span class="g g-Whitespace">    </span><span class="mi">987</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">997</span><span class="sd">     The joint loglikelihood.</span>
<span class="g g-Whitespace">    </span><span class="mi">998</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">999</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;conserve_memory&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1000</span>                   <span class="n">MEMORY_CONSERVE</span> <span class="o">^</span> <span class="n">MEMORY_NO_LIKELIHOOD</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1001</span> <span class="n">kfilter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filter</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1002</span> <span class="n">loglikelihood_burn</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;loglikelihood_burn&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1003</span>                                 <span class="bp">self</span><span class="o">.</span><span class="n">loglikelihood_burn</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1004</span> <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;conserve_memory&#39;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">MEMORY_NO_LIKELIHOOD</span><span class="p">):</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\statsmodels\tsa\statespace\kalman_filter.py:921,</span> in <span class="ni">KalmanFilter._filter</span><span class="nt">(self, filter_method, inversion_method, stability_method, conserve_memory, filter_timing, tolerance, loglikelihood_burn, complex_step)</span>
<span class="g g-Whitespace">    </span><span class="mi">918</span> <span class="n">kfilter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kalman_filters</span><span class="p">[</span><span class="n">prefix</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">920</span> <span class="c1"># Initialize the state</span>
<span class="ne">--&gt; </span><span class="mi">921</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_state</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span> <span class="n">complex_step</span><span class="o">=</span><span class="n">complex_step</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">923</span> <span class="c1"># Run the filter</span>
<span class="g g-Whitespace">    </span><span class="mi">924</span> <span class="n">kfilter</span><span class="p">()</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\statsmodels\tsa\statespace\representation.py:1058,</span> in <span class="ni">Representation._initialize_state</span><span class="nt">(self, prefix, complex_step)</span>
<span class="g g-Whitespace">   </span><span class="mi">1056</span>     <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">initialized</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1057</span>         <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Initialization is incomplete.&#39;</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1058</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_statespaces</span><span class="p">[</span><span class="n">prefix</span><span class="p">]</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialization</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1059</span>                                          <span class="n">complex_step</span><span class="o">=</span><span class="n">complex_step</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1060</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1061</span>     <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Statespace model not initialized.&#39;</span><span class="p">)</span>

<span class="nn">File statsmodels\\tsa\\statespace\\_representation.pyx:1373,</span> in <span class="ni">statsmodels.tsa.statespace._representation.dStatespace.initialize</span><span class="nt">()</span>

<span class="nn">File statsmodels\\tsa\\statespace\\_representation.pyx:1360,</span> in <span class="ni">statsmodels.tsa.statespace._representation.dStatespace.initialize</span><span class="nt">()</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\statsmodels\tsa\statespace\initialization.py:375,</span> in <span class="ni">Initialization._initialize_initialization</span><span class="nt">(self, prefix)</span>
<span class="g g-Whitespace">    </span><span class="mi">370</span> <span class="c1"># If they do exist, update them</span>
<span class="g g-Whitespace">    </span><span class="mi">371</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">372</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_representations</span><span class="p">[</span><span class="n">prefix</span><span class="p">][</span><span class="s1">&#39;constant&#39;</span><span class="p">][:]</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">373</span>         <span class="bp">self</span><span class="o">.</span><span class="n">constant</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)[:])</span>
<span class="g g-Whitespace">    </span><span class="mi">374</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_representations</span><span class="p">[</span><span class="n">prefix</span><span class="p">][</span><span class="s1">&#39;stationary_cov&#39;</span><span class="p">][:]</span> <span class="o">=</span> <span class="p">(</span>
<span class="ne">--&gt; </span><span class="mi">375</span>         <span class="bp">self</span><span class="o">.</span><span class="n">stationary_cov</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)[:])</span>
<span class="g g-Whitespace">    </span><span class="mi">377</span> <span class="c1"># Create if necessary</span>
<span class="g g-Whitespace">    </span><span class="mi">378</span> <span class="k">if</span> <span class="n">prefix</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initializations</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">379</span>     <span class="c1"># Setup the base statespace object</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<p>Con el modelo SARIMA se siguen mantiendo metricas inadecuadas.
Se explora con una transformacion de datos en este mismo  modelo SARIMA.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.statespace.sarimax</span> <span class="kn">import</span> <span class="n">SARIMAX</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Aplicar transformación logarítmica</span>
<span class="n">consumo_ts_log</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">consumo_ts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Sumar 1 para evitar log(0)</span>

<span class="c1"># Definir los posibles valores de p, d, q y P, D, Q (estacionales)</span>
<span class="n">p_values</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">d_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">q_values</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">P_values</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">D_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">Q_values</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">seasonal_period</span> <span class="o">=</span> <span class="mi">12</span>

<span class="c1"># Almacenar resultados de las métricas para cada combinación de parámetros</span>
<span class="n">sarima_results_log</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Iterar sobre todas las combinaciones posibles de parámetros</span>
<span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">Q</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="n">p_values</span><span class="p">,</span> <span class="n">d_values</span><span class="p">,</span> <span class="n">q_values</span><span class="p">,</span> <span class="n">P_values</span><span class="p">,</span> <span class="n">D_values</span><span class="p">,</span> <span class="n">Q_values</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Ajustar el modelo SARIMA a los datos logarítmicos</span>
        <span class="n">model_sarima_log</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">consumo_ts_log</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">seasonal_period</span><span class="p">))</span>
        <span class="n">fit_sarima_log</span> <span class="o">=</span> <span class="n">model_sarima_log</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Calcular las métricas de precisión</span>
        <span class="n">y_pred_log</span> <span class="o">=</span> <span class="n">fit_sarima_log</span><span class="o">.</span><span class="n">fittedvalues</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">y_pred_log</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># Invertir la transformación logarítmica</span>
        
        <span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">consumo_ts</span><span class="p">)</span>
        <span class="n">prederr</span> <span class="o">=</span> <span class="n">consumo_ts</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">values</span>
        <span class="n">SSE</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prederr</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">MAPE</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prederr</span> <span class="o">/</span> <span class="n">consumo_ts</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">/</span> <span class="n">T</span>
        <span class="n">MAD</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prederr</span><span class="p">))</span> <span class="o">/</span> <span class="n">T</span>
        <span class="n">MSD</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">consumo_ts</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

        <span class="c1"># Almacenar resultados</span>
        <span class="n">metrics_sarima_log</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span>
            <span class="s2">&quot;SSE&quot;</span><span class="p">:</span> <span class="n">SSE</span><span class="p">,</span>
            <span class="s2">&quot;MAPE&quot;</span><span class="p">:</span> <span class="n">MAPE</span><span class="p">,</span>
            <span class="s2">&quot;MAD&quot;</span><span class="p">:</span> <span class="n">MAD</span><span class="p">,</span>
            <span class="s2">&quot;MSD&quot;</span><span class="p">:</span> <span class="n">MSD</span><span class="p">,</span>
            <span class="s2">&quot;p&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">,</span>
            <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="n">d</span><span class="p">,</span>
            <span class="s2">&quot;q&quot;</span><span class="p">:</span> <span class="n">q</span><span class="p">,</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:</span> <span class="n">P</span><span class="p">,</span>
            <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="n">D</span><span class="p">,</span>
            <span class="s2">&quot;Q&quot;</span><span class="p">:</span> <span class="n">Q</span>
        <span class="p">})</span>

        <span class="n">sarima_results_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metrics_sarima_log</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">continue</span>

<span class="c1"># Crear un DataFrame para visualizar los resultados</span>
<span class="n">sarima_results_df_log</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sarima_results_log</span><span class="p">)</span>
<span class="n">sarima_results_df_log_sorted</span> <span class="o">=</span> <span class="n">sarima_results_df_log</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;MAPE&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sarima_results_df_log_sorted</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              SSE        MAPE       MAD        MSD    p    d    q    P    D  \
38    3776.186453   68.152670  3.868480  23.309793  0.0  0.0  2.0  0.0  0.0   
20    4406.214363   69.134292  4.161577  27.198854  0.0  0.0  1.0  0.0  0.0   
264   2053.861065   70.008796  2.824687  12.678155  2.0  0.0  2.0  2.0  0.0   
254   2059.105017   70.105397  2.821039  12.710525  2.0  0.0  2.0  0.0  0.0   
259   2081.742725   70.288991  2.832770  12.850264  2.0  0.0  2.0  1.0  0.0   
..            ...         ...       ...        ...  ...  ...  ...  ...  ...   
71    4775.998988  115.281274  4.314034  29.481475  0.0  1.0  0.0  2.0  1.0   
65    4773.191603  115.584409  4.312004  29.464146  0.0  1.0  0.0  1.0  1.0   
69    7540.813220  128.367194  5.211139  46.548230  0.0  1.0  0.0  2.0  1.0   
63    9337.587918  132.335239  5.459083  57.639432  0.0  1.0  0.0  1.0  1.0   
57   14031.972062  143.392343  6.240317  86.617111  0.0  1.0  0.0  0.0  1.0   

       Q  
38   2.0  
20   2.0  
264  0.0  
254  2.0  
259  1.0  
..   ...  
71   2.0  
65   2.0  
69   0.0  
63   0.0  
57   0.0  

[324 rows x 10 columns]
</pre></div>
</div>
</div>
</div>
</section>
<section id="prueba-con-modelos-de-machine-learnig">
<h1>Prueba con modelos de Machine Learnig<a class="headerlink" href="#prueba-con-modelos-de-machine-learnig" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>xgboost
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># Crear características de retraso (lags) y características temporales</span>
<span class="k">def</span> <span class="nf">create_features</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">target_col</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">12</span><span class="p">):</span>
    <span class="c1"># Crear un DataFrame con las características de lags</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lags</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">data</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">lag</span><span class="p">)</span>
    
    <span class="c1"># Agregar características temporales</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span>
    
    <span class="c1"># Eliminar valores NaN creados por los lags</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">data</span>

<span class="c1"># Crear características para el modelo</span>
<span class="n">data_features</span> <span class="o">=</span> <span class="n">create_features</span><span class="p">(</span><span class="n">consumo_ts</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Consumption&#39;</span><span class="p">),</span> <span class="s1">&#39;Consumption&#39;</span><span class="p">)</span>

<span class="c1"># Dividir en variables predictoras (X) y variable objetivo (y)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data_features</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Consumption&#39;</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data_features</span><span class="p">[</span><span class="s1">&#39;Consumption&#39;</span><span class="p">]</span>

<span class="c1"># Dividir en conjuntos de entrenamiento y prueba</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Ajustar el modelo XGBoost</span>
<span class="n">model_xgb</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">model_xgb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Hacer predicciones</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model_xgb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Calcular el MAPE</span>
<span class="n">mape_xgb</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;MAPE for XGBoost: </span><span class="si">{</span><span class="n">mape_xgb</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAPE for XGBoost: 45.13%
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># Crear características personalizadas</span>
<span class="k">def</span> <span class="nf">create_features</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">target_col</span><span class="p">):</span>
    <span class="c1"># Crear DataFrame para almacenar características</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">])</span>
    
    <span class="c1"># Crear características de lags</span>
    <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">):</span>
        <span class="n">data</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">lag</span><span class="p">)</span>
    
    <span class="c1"># Crear características temporales</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;day_of_week&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofweek</span>

    <span class="c1"># Crear características derivadas</span>
    <span class="c1"># Promedio móvil</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;rolling_mean_3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;rolling_mean_6&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="c1"># Tendencia (diferencia con el valor de hace un año)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;trend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

    <span class="c1"># Eliminar filas con NaN creadas por el proceso de creación de características</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">data</span>

<span class="c1"># Crear características para el modelo</span>
<span class="n">data_features</span> <span class="o">=</span> <span class="n">create_features</span><span class="p">(</span><span class="n">consumo_ts</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Consumption&#39;</span><span class="p">),</span> <span class="s1">&#39;Consumption&#39;</span><span class="p">)</span>

<span class="c1"># Dividir en variables predictoras (X) y variable objetivo (y)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data_features</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Consumption&#39;</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data_features</span><span class="p">[</span><span class="s1">&#39;Consumption&#39;</span><span class="p">]</span>

<span class="c1"># Dividir en conjuntos de entrenamiento y prueba</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Ajustar el modelo de regresión lineal</span>
<span class="n">model_lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model_lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Hacer predicciones</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model_lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Calcular el MAPE</span>
<span class="n">mape_lr</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;MAPE for Linear Regression: </span><span class="si">{</span><span class="n">mape_lr</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>

<span class="c1"># Mostrar algunas predicciones</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Predicciones:&#39;</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Valores Reales:&#39;</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAPE for Linear Regression: 0.00%
Predicciones: [10. 12.  9.  7.  7.]
Valores Reales: [10 12  9  7  7]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calcular el MAPE</span>
<span class="n">mape_lr</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;MAPE for Linear Regression: </span><span class="si">{</span><span class="n">mape_lr</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAPE for Linear Regression: 0.00%
</pre></div>
</div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Welcome to your Jupyter Book</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Proyecto - Modelamiento de una serie de tiempo para predecir el consumo de transmisiones en camiones mineros</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#iniciamos-con-el-eda-de-la-serie-que-se-requiere-estudiar">Iniciamos con el EDA de la serie que se requiere estudiar</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#test-de-normalidad-de-los-datos">Test de Normalidad de los datos</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#validacion-de-datos-faltantes">Validacion de datos faltantes</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#generacion-de-la-serie-de-tiempo">Generacion de la serie de tiempo</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#se-determinara-a-que-modelo-se-ajustan-nuestros-datos">Se determinara a que modelo se ajustan nuestros datos:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#validacion-de-estacionalidad-de-la-serie">Validacion de estacionalidad de la serie</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#descomposicion-de-mi-serie">Descomposicion de mi serie</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#suavizacion-exponencial">Suavizacion exponencial</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-autorregresivo-integral-de-media-movil">MODELO AUTORREGRESIVO INTEGRAL DE MEDIA MOVIL</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-con-modelos-de-machine-learnig">Prueba con modelos de Machine Learnig</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ernesto de Jesus Rodriguez Zaccaro
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>